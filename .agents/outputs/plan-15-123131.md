# Implementation Plan
**Generated**: 2025-12-31 23:58 PST
**Generated By**: Scout-and-Plan Agent (combined workflow)
**Task ID**: GitHub Issue #15
**Estimated Build Time**: 3-4 hours
**Complexity**: Medium

## Investigation Summary

### Request Analysis
**Type**: Performance Optimization
**Source**: GitHub Issue #15
**Priority**: Medium

### Task Classification
**Category**: PERFORMANCE
**Test Strategy**: STANDARD (Build + lint + visual verification)

### Current State Assessment

**Image Inventory (Total: 15MB)**:

| Directory | Images | Total Size | Used in App.jsx |
|-----------|--------|------------|-----------------|
| /hero | 1 | 540KB | No (CSS background) |
| /sections | 3 | 2.0MB | Yes (3 img tags) |
| /logos | 5 | 1.9MB | Yes (2 img tags) |
| /icons | 17 | 7.5MB | No (unused) |
| /patterns | 1 | 944KB | No (unused) |
| /social | 3 | 1.5MB | No (meta tags) |

**Images Currently Used in App.jsx** (5 total):
1. `/images/logos/logo-nav.png` (28KB) - Line 281 - Navigation logo
2. `/images/sections/secure-on-premise-ai-server.png` (535KB) - Line 559 - Confidential AI section
3. `/images/sections/ai-ready-pdx-team-portland.jpg` (952KB) - Line 687 - FAQ section
4. `/images/sections/ai-strategy-consultation-portland.png` (588KB) - Line 736 - Contact section
5. `/images/logos/logo-full.png` (61KB) - Line 849 - Footer logo

**Critical Finding**: Many PNG files are actually JPEG data (misnamed):
- `ai-strategy-consultation-portland.png` - Actually JPEG
- `secure-on-premise-ai-server.png` - Actually JPEG
- `logo-full-white.png` - Actually JPEG
- `logo-icon.png` - Actually JPEG
- `logo-wordmark.png` - Actually JPEG

**Current Image Implementation**:
- No lazy loading (`loading="lazy"`) on any images
- No responsive images (srcset)
- No WebP format
- No `<picture>` element fallbacks
- No width/height attributes (causes layout shift)

### Complexity Assessment
**Complexity**: Moderate
**Effort**: 3-4 hours
**Risk**: Medium - Image conversion requires external tools; need to ensure fallbacks for older browsers

### Patterns Identified
**Primary**: Standard `<img>` tags with className and alt attributes
**Reference**: Lines 281, 558-562, 686-689, 735-738, 849 in App.jsx

### Tools Available
- libwebp libraries installed (system libraries)
- cwebp CLI tool NOT installed (needs `sudo apt install webp`)
- sharp (Node.js image library) NOT installed

---

## Executive Summary

This plan converts the 5 actively-used images from PNG/JPG to WebP format, adds lazy loading, includes width/height attributes to prevent layout shift, and implements `<picture>` elements for browser fallback support. Expected file size reduction: 25-35% (~500KB savings on actively used images).

## Phase 1: Install Image Conversion Tools

### Subtask 1.1: Install cwebp Command Line Tool
**Instructions**:
1. Install the webp package which provides cwebp:
```bash
sudo apt install webp
```
2. Verify installation:
```bash
cwebp -version
```

**Validation**:
```bash
which cwebp
cwebp -version
```

**Completion Criteria**:
- [ ] cwebp command available
- [ ] Version output shows successfully

---

## Phase 2: Convert Images to WebP Format

### Subtask 2.1: Convert Section Images
**Instructions**:
1. Convert each section image to WebP with quality 80:
```bash
# ai-ready-pdx-team-portland.jpg (952KB)
cwebp -q 80 /home/pbrown/aireadypdx/public/images/sections/ai-ready-pdx-team-portland.jpg -o /home/pbrown/aireadypdx/public/images/sections/ai-ready-pdx-team-portland.webp

# ai-strategy-consultation-portland.png (588KB) - Actually JPEG
cwebp -q 80 /home/pbrown/aireadypdx/public/images/sections/ai-strategy-consultation-portland.png -o /home/pbrown/aireadypdx/public/images/sections/ai-strategy-consultation-portland.webp

# secure-on-premise-ai-server.png (535KB) - Actually JPEG
cwebp -q 80 /home/pbrown/aireadypdx/public/images/sections/secure-on-premise-ai-server.png -o /home/pbrown/aireadypdx/public/images/sections/secure-on-premise-ai-server.webp
```

**Validation**:
```bash
ls -la /home/pbrown/aireadypdx/public/images/sections/*.webp
```

**Completion Criteria**:
- [ ] 3 WebP files created in sections directory
- [ ] Each WebP file is smaller than original

### Subtask 2.2: Convert Logo Images
**Instructions**:
1. Convert used logo images to WebP:
```bash
# logo-nav.png (28KB) - True PNG
cwebp -q 90 /home/pbrown/aireadypdx/public/images/logos/logo-nav.png -o /home/pbrown/aireadypdx/public/images/logos/logo-nav.webp

# logo-full.png (61KB) - True PNG
cwebp -q 90 /home/pbrown/aireadypdx/public/images/logos/logo-full.png -o /home/pbrown/aireadypdx/public/images/logos/logo-full.webp
```

**Note**: Use quality 90 for logos to preserve text/line sharpness.

**Validation**:
```bash
ls -la /home/pbrown/aireadypdx/public/images/logos/*.webp
```

**Completion Criteria**:
- [ ] 2 WebP files created in logos directory
- [ ] Logo quality is acceptable (no artifacts on text)

---

## Phase 3: Update App.jsx with Picture Elements

### Subtask 3.1: Update Navigation Logo (Line 281)
**File**: `/home/pbrown/aireadypdx/src/App.jsx`
**Current** (Line 281):
```jsx
<img src="/images/logos/logo-nav.png" alt="AI Ready PDX" className="nav-logo-img" />
```

**Replace with**:
```jsx
<picture>
  <source srcSet="/images/logos/logo-nav.webp" type="image/webp" />
  <img
    src="/images/logos/logo-nav.png"
    alt="AI Ready PDX"
    className="nav-logo-img"
    width="200"
    height="109"
  />
</picture>
```

**Note**: Nav logo should NOT have lazy loading (above fold, critical).

**Completion Criteria**:
- [ ] Picture element wraps img tag
- [ ] WebP source comes first
- [ ] Width/height attributes added

### Subtask 3.2: Update Confidential AI Image (Lines 558-562)
**File**: `/home/pbrown/aireadypdx/src/App.jsx`
**Current**:
```jsx
<img
  src="/images/sections/secure-on-premise-ai-server.png"
  alt="Secure on-premise AI server for confidential business data"
  className="confidential-ai-img"
/>
```

**Replace with**:
```jsx
<picture>
  <source srcSet="/images/sections/secure-on-premise-ai-server.webp" type="image/webp" />
  <img
    src="/images/sections/secure-on-premise-ai-server.png"
    alt="Secure on-premise AI server for confidential business data"
    className="confidential-ai-img"
    loading="lazy"
    width="1408"
    height="768"
  />
</picture>
```

**Completion Criteria**:
- [ ] Picture element wraps img tag
- [ ] loading="lazy" attribute added
- [ ] Width/height attributes added

### Subtask 3.3: Update FAQ Section Image (Lines 686-689)
**File**: `/home/pbrown/aireadypdx/src/App.jsx`
**Current**:
```jsx
<img
  src="/images/sections/ai-ready-pdx-team-portland.jpg"
  alt="AI Ready PDX consulting team helping Portland businesses with AI adoption"
  className="section-image about-image"
/>
```

**Replace with**:
```jsx
<picture>
  <source srcSet="/images/sections/ai-ready-pdx-team-portland.webp" type="image/webp" />
  <img
    src="/images/sections/ai-ready-pdx-team-portland.jpg"
    alt="AI Ready PDX consulting team helping Portland businesses with AI adoption"
    className="section-image about-image"
    loading="lazy"
    width="1408"
    height="768"
  />
</picture>
```

**Completion Criteria**:
- [ ] Picture element wraps img tag
- [ ] loading="lazy" attribute added
- [ ] Width/height attributes added

### Subtask 3.4: Update Contact Section Image (Lines 735-738)
**File**: `/home/pbrown/aireadypdx/src/App.jsx`
**Current**:
```jsx
<img
  src="/images/sections/ai-strategy-consultation-portland.png"
  alt="AI strategy consultation session with Portland business owner"
  className="section-image contact-image"
/>
```

**Replace with**:
```jsx
<picture>
  <source srcSet="/images/sections/ai-strategy-consultation-portland.webp" type="image/webp" />
  <img
    src="/images/sections/ai-strategy-consultation-portland.png"
    alt="AI strategy consultation session with Portland business owner"
    className="section-image contact-image"
    loading="lazy"
    width="1408"
    height="768"
  />
</picture>
```

**Completion Criteria**:
- [ ] Picture element wraps img tag
- [ ] loading="lazy" attribute added
- [ ] Width/height attributes added

### Subtask 3.5: Update Footer Logo (Line 849)
**File**: `/home/pbrown/aireadypdx/src/App.jsx`
**Current**:
```jsx
<img src="/images/logos/logo-full.png" alt="AI Ready PDX" className="footer-logo-img" />
```

**Replace with**:
```jsx
<picture>
  <source srcSet="/images/logos/logo-full.webp" type="image/webp" />
  <img
    src="/images/logos/logo-full.png"
    alt="AI Ready PDX"
    className="footer-logo-img"
    loading="lazy"
    width="300"
    height="163"
  />
</picture>
```

**Completion Criteria**:
- [ ] Picture element wraps img tag
- [ ] loading="lazy" attribute added
- [ ] Width/height attributes added

---

## Phase 4: Validation and Testing

### Subtask 4.1: Build and Lint
**Instructions**:
```bash
cd /home/pbrown/aireadypdx && npm run build && npm run lint
```

**Completion Criteria**:
- [ ] Build completes successfully
- [ ] No lint errors

### Subtask 4.2: Verify File Size Savings
**Instructions**:
```bash
# Compare original vs WebP sizes
echo "=== Section Images ==="
ls -la /home/pbrown/aireadypdx/public/images/sections/*.jpg /home/pbrown/aireadypdx/public/images/sections/*.png /home/pbrown/aireadypdx/public/images/sections/*.webp

echo "=== Logo Images ==="
ls -la /home/pbrown/aireadypdx/public/images/logos/logo-nav.* /home/pbrown/aireadypdx/public/images/logos/logo-full.*
```

**Expected Savings**: ~25-35% reduction per image

**Completion Criteria**:
- [ ] WebP files are smaller than originals
- [ ] Total savings documented

### Subtask 4.3: Visual Verification
**Instructions**:
1. Start dev server: `npm run dev`
2. Open http://localhost:5173
3. Verify each image loads correctly:
   - Navigation logo (visible immediately)
   - Confidential AI section image
   - FAQ section team image
   - Contact section image
   - Footer logo
4. Open DevTools > Network tab
5. Reload page and verify WebP versions are being served (in browsers that support WebP)
6. Test in Safari or older browser to verify PNG/JPG fallback works

**Completion Criteria**:
- [ ] All 5 images display correctly
- [ ] No broken images
- [ ] WebP served in modern browsers
- [ ] Fallback works in older browsers

---

## Summary of Deliverables

**Files Modified**:
- `/home/pbrown/aireadypdx/src/App.jsx` - 5 image elements updated with `<picture>` wrapper

**Files Created**:
- `/home/pbrown/aireadypdx/public/images/sections/ai-ready-pdx-team-portland.webp`
- `/home/pbrown/aireadypdx/public/images/sections/ai-strategy-consultation-portland.webp`
- `/home/pbrown/aireadypdx/public/images/sections/secure-on-premise-ai-server.webp`
- `/home/pbrown/aireadypdx/public/images/logos/logo-nav.webp`
- `/home/pbrown/aireadypdx/public/images/logos/logo-full.webp`

**Expected Performance Improvement**:
- Original total: ~2.2MB for 5 used images
- Expected after: ~1.5MB (30% reduction)
- Added lazy loading for 4 below-fold images
- Added width/height to prevent layout shift (CLS improvement)

---

## Handoff to Build Agent

1. Execute subtasks in exact order (Phase 1 must complete before Phase 2)
2. Phase 1 requires sudo access for apt install
3. Test completion criteria before next subtask
4. Keep original PNG/JPG files as fallbacks (do not delete)
5. Run `npm run dev` for visual verification after Phase 3

---

## Performance Metrics

| Phase | Duration |
|-------|----------|
| Issue Classification | 1m |
| Investigation | 5m |
| Pattern Identification | 2m |
| Validation | 2m |
| Planning | 8m |
| **Total** | **18m** |

---

## Insights & Process Improvements (REQUIRED)

### Issues Encountered During Investigation

1. **Misnamed file extensions** - Several PNG files are actually JPEG data (verified via `file` command). This doesn't affect conversion but is worth noting for future cleanup. cwebp handles this gracefully.

2. **Large unused image assets** - 7.5MB of icon images in `/icons/` directory are not currently used in App.jsx. Consider removing or optimizing these in a future issue.

3. **No cwebp tool installed** - The webp library is installed but not the command-line conversion tool. Build agent will need sudo access to install it.

### Input Quality Assessment
**Clarity of Original Request**: 4/5
**Missing Information**:
- Image dimensions (had to check via file command)
- Acceptable quality level for WebP conversion
- Whether to also optimize unused images

**Suggested Input Improvements**:
- Include list of specific images to optimize vs all images
- Specify target quality level (lossy vs lossless)

### Process Improvement Suggestions

**For Future Scout-and-Plan Runs**:
1. Check for image conversion tools availability earlier in investigation
2. Run `file` command on all images to detect format mismatches

**For Build Agent**:
1. Phase 1 requires sudo - may need user confirmation
2. After conversion, verify WebP quality visually before proceeding to JSX changes
3. Keep original files for fallback - do NOT delete them

**For Overall Workflow**:
1. Consider adding a Vite plugin for automatic WebP conversion during build (vite-imagetools) for future images
2. Add responsive images (srcset) as a follow-up enhancement for retina displays
