# Implementation Plan
**Generated**: 2026-01-01 00:50 PST
**Generated By**: Scout-and-Plan Agent (combined workflow)
**Task ID**: GitHub Issue #30 - [Parent #6] Set up routing infrastructure and extract shared components
**Estimated Build Time**: 4-6 hours
**Complexity**: High

## Investigation Summary

### Request Analysis
**Type**: Feature (Architecture)
**Source**: GitHub Issue #30
**Priority**: High (Foundation for all service page sub-issues)

### Task Classification
**Category**: FEATURE
**Test Strategy**: THOROUGH (Build + lint + responsive testing for layout changes)

### Current State Assessment

**Codebase Structure**:
- Main component: `src/App.jsx` (927 lines) - monolithic component containing all sections
- Routing: `src/main.jsx` (20 lines) - uses react-router-dom v7.11.0 (already installed)
- Current routes: `/` (App) and `/novus-migration-status` (standalone page)
- Existing components: `src/components/ChatWidget/` and `src/components/NewsletterPopup/`
- CSS: `src/index.css` (1492 lines) and `src/App.css` (171 lines)

**Key Extractions Required**:
1. **Icons** (lines 8-178): 22 SVG icon components in an `Icons` object
2. **Navigation** (lines 278-305): Navbar with mobile hamburger, scroll-to-section logic
3. **Footer** (lines 886-915): Footer with branding, contact info, build info
4. **scrollToSection function** (lines 191-204): Smooth scroll logic with offset

**State Management in App.jsx**:
- `mobileMenuOpen` - for mobile nav toggle (needs to stay with Navigation)
- `formData`, `formSubmitted`, `formError`, `formLoading` - contact form (stays in App)
- `openFaq` - FAQ accordion (stays in App)
- `showMobileCTA` - mobile CTA visibility (stays in App or move to Navigation)

### Complexity Assessment
**Complexity**: High
**Effort**: 4-6 hours
**Risk**: Medium - Multiple files, navigation behavior changes, potential for regression

### Patterns Identified

**Primary Component Pattern** (from ChatWidget):
```
src/components/ComponentName/
  - ComponentName.jsx (main component)
  - ComponentName.css (component styles)
  - helpers.jsx (optional helper components/icons)
```

**Alternative Pattern** (from NewsletterPopup):
```
src/components/ComponentName/
  - ComponentName.jsx
  - ComponentName.css
  - index.js (re-export for cleaner imports)
```

**Existing Page Pattern** (from NovusMigrationStatus):
- Standalone page component in `src/pages/`
- Has its own CSS file
- Manages its own document title via useEffect

---

## Executive Summary

This implementation creates the foundational routing infrastructure and shared components for the service pages architecture. We will:
1. Extract Icons, Navigation, Footer into reusable components
2. Create a Layout wrapper that combines Navigation + content + Footer
3. Update main.jsx to support nested routes for `/services/*` and `/about`
4. Refactor App.jsx to use the extracted components
5. Create placeholder service pages that use the Layout component

The key challenge is handling navigation behavior: same-page smooth scroll on homepage vs. cross-page navigation + scroll on service pages.

---

## Phase 1: Extract Icons Component

### Subtask 1.1: Create Icons Component File
**File**: `/home/pbrown/aireadypdx/src/components/Icons/Icons.jsx`
**Pattern**: Follow ChatWidget pattern with helper file for icons
**Instructions**:
1. Create directory `src/components/Icons/`
2. Create `Icons.jsx` with the Icons object extracted from App.jsx (lines 8-178)
3. Export the Icons object as default AND named export for flexibility

**Code Structure**:
```jsx
// Icons.jsx
const Icons = {
  Award: () => (
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" ...>
      ...
    </svg>
  ),
  // ... all other icons from App.jsx lines 9-178
}

export { Icons }
export default Icons
```

**Validation**:
```bash
npm run lint
```
**Completion Criteria**:
- [ ] File created at correct location
- [ ] All 22 icons extracted: Award, MapPin, Shield, Briefcase, CheckCircle, Check, MessageSquare, Menu, X, Search, Settings, Users, Home, Coffee, Clipboard, Building, Heart, Factory, GraduationCap, Megaphone, Cog, BarChart, Lock
- [ ] Export works (both default and named)

---

## Phase 2: Extract Navigation Component

### Subtask 2.1: Create Navigation Component
**File**: `/home/pbrown/aireadypdx/src/components/Navigation/Navigation.jsx`
**Pattern**: Component folder with CSS file
**Instructions**:
1. Create directory `src/components/Navigation/`
2. Create `Navigation.jsx` with:
   - Import Icons from `../Icons/Icons`
   - Accept props: `scrollToSection` function OR handle navigation internally
   - Manage `mobileMenuOpen` state internally
   - Handle both same-page scroll and cross-page navigation

**Navigation Logic Requirements**:
- Use `useLocation` from react-router-dom to detect current page
- If on homepage (`/`), use smooth scroll to sections
- If on other pages, navigate to `/#section-id` using `useNavigate`

**Code Structure**:
```jsx
import { useState } from 'react'
import { useLocation, useNavigate } from 'react-router-dom'
import { Icons } from '../Icons/Icons'
import './Navigation.css'

function Navigation() {
  const [mobileMenuOpen, setMobileMenuOpen] = useState(false)
  const location = useLocation()
  const navigate = useNavigate()

  const scrollToSection = (e, sectionId) => {
    e.preventDefault()
    setMobileMenuOpen(false)

    if (location.pathname === '/') {
      // Same-page smooth scroll
      const element = document.getElementById(sectionId)
      if (element) {
        const offset = 80
        const elementPosition = element.getBoundingClientRect().top
        const offsetPosition = elementPosition + window.pageYOffset - offset
        window.scrollTo({
          top: offsetPosition,
          behavior: 'smooth'
        })
      }
    } else {
      // Cross-page navigation
      navigate(`/#${sectionId}`)
    }
  }

  return (
    <nav className="navbar">
      {/* ... navbar content from App.jsx lines 278-305 */}
    </nav>
  )
}

export default Navigation
```

**Validation**:
```bash
npm run lint
```
**Completion Criteria**:
- [ ] Navigation component created
- [ ] Mobile menu toggle works
- [ ] Icons imported correctly
- [ ] Navigation links use scrollToSection

### Subtask 2.2: Create Navigation CSS
**File**: `/home/pbrown/aireadypdx/src/components/Navigation/Navigation.css`
**Instructions**:
1. Extract navigation-related styles from `src/index.css` (lines 211-271)
2. Include mobile responsive styles (lines 1389-1419)
3. Include nav-cta button styles (lines 502-506)

**Styles to Extract**:
- `.navbar` (lines 211-221)
- `.navbar .container` (lines 223-227)
- `.nav-logo`, `.nav-logo-img` (lines 229-238)
- `.nav-links` and related (lines 240-255)
- `.nav-toggle` (lines 257-271)
- Mobile styles for nav (lines 1389-1419)

**Note**: Keep these styles in index.css as well for now to avoid breaking anything. We can remove duplicates in a cleanup phase.

**Validation**:
```bash
npm run build
```
**Completion Criteria**:
- [ ] Navigation.css created with relevant styles
- [ ] No CSS conflicts

---

## Phase 3: Extract Footer Component

### Subtask 3.1: Create Footer Component
**File**: `/home/pbrown/aireadypdx/src/components/Footer/Footer.jsx`
**Instructions**:
1. Create directory `src/components/Footer/`
2. Create `Footer.jsx` with footer content from App.jsx (lines 886-915)
3. Import analytics tracking functions
4. Accept `openNewsletterPopup` as prop or dispatch custom event

**Code Structure**:
```jsx
import { trackEmailClick, trackPhoneClick } from '../../utils/analytics'
import './Footer.css'

function Footer() {
  const openNewsletterPopup = (e) => {
    e.preventDefault()
    window.dispatchEvent(new CustomEvent('openNewsletterPopup'))
  }

  return (
    <footer className="footer">
      {/* ... footer content from App.jsx lines 886-915 */}
    </footer>
  )
}

export default Footer
```

**Validation**:
```bash
npm run lint
```
**Completion Criteria**:
- [ ] Footer component created
- [ ] Analytics tracking functions imported
- [ ] Newsletter popup integration works
- [ ] Build info displays correctly (`__BUILD_TIME__`)

### Subtask 3.2: Create Footer CSS
**File**: `/home/pbrown/aireadypdx/src/components/Footer/Footer.css`
**Instructions**:
1. Extract footer styles from `src/index.css` (lines 1280-1348)
2. Include responsive styles (lines 1465-1476)

**Validation**:
```bash
npm run build
```
**Completion Criteria**:
- [ ] Footer.css created with relevant styles

---

## Phase 4: Create Layout Component

### Subtask 4.1: Create Layout Wrapper Component
**File**: `/home/pbrown/aireadypdx/src/components/Layout/Layout.jsx`
**Instructions**:
1. Create directory `src/components/Layout/`
2. Create `Layout.jsx` that wraps:
   - Navigation component
   - `{children}` (page content via Outlet)
   - Footer component
   - ChatWidget and NewsletterPopup (shared across all pages)

**Code Structure**:
```jsx
import { Outlet } from 'react-router-dom'
import Navigation from '../Navigation/Navigation'
import Footer from '../Footer/Footer'
import ChatWidget from '../ChatWidget/ChatWidget'
import NewsletterPopup from '../NewsletterPopup'
import './Layout.css'

function Layout() {
  return (
    <div className="app">
      <Navigation />
      <Outlet />
      <Footer />
      <ChatWidget />
      <NewsletterPopup />
    </div>
  )
}

export default Layout
```

**Validation**:
```bash
npm run lint
```
**Completion Criteria**:
- [ ] Layout component created
- [ ] Uses Outlet for nested routes
- [ ] Includes all shared components

### Subtask 4.2: Create Layout CSS (if needed)
**File**: `/home/pbrown/aireadypdx/src/components/Layout/Layout.css`
**Instructions**:
1. Create minimal CSS file
2. Move `.app` styles from App.css if needed

**Code**:
```css
/* Layout wrapper styles */
.app {
  min-height: 100vh;
}
```

**Validation**:
```bash
npm run build
```
**Completion Criteria**:
- [ ] Layout.css created

---

## Phase 5: Update Routing Structure

### Subtask 5.1: Update main.jsx with Nested Routes
**File**: `/home/pbrown/aireadypdx/src/main.jsx`
**Instructions**:
1. Import Layout component
2. Create nested route structure with Layout as parent
3. Add placeholder routes for service pages
4. Handle hash-based navigation on page load

**Code Structure**:
```jsx
import { StrictMode, useEffect } from 'react'
import { createRoot } from 'react-dom/client'
import { BrowserRouter, Routes, Route, useLocation } from 'react-router-dom'
import { Analytics } from '@vercel/analytics/react'
import './index.css'
import Layout from './components/Layout/Layout'
import App from './App.jsx'
import NovusMigrationStatus from './pages/NovusMigrationStatus.jsx'

// Component to handle hash scrolling after navigation
function ScrollToHash() {
  const location = useLocation()

  useEffect(() => {
    if (location.hash) {
      const id = location.hash.replace('#', '')
      setTimeout(() => {
        const element = document.getElementById(id)
        if (element) {
          const offset = 80
          const elementPosition = element.getBoundingClientRect().top
          const offsetPosition = elementPosition + window.pageYOffset - offset
          window.scrollTo({
            top: offsetPosition,
            behavior: 'smooth'
          })
        }
      }, 100) // Small delay to ensure page is rendered
    }
  }, [location])

  return null
}

createRoot(document.getElementById('root')).render(
  <StrictMode>
    <BrowserRouter>
      <ScrollToHash />
      <Routes>
        <Route element={<Layout />}>
          <Route path="/" element={<App />} />
          <Route path="/services/ai-consulting" element={<div>AI Consulting Page (Coming Soon)</div>} />
          <Route path="/services/workflow-automation" element={<div>Workflow Automation Page (Coming Soon)</div>} />
          <Route path="/services/employee-training" element={<div>Employee Training Page (Coming Soon)</div>} />
          <Route path="/services/confidential-ai" element={<div>Confidential AI Page (Coming Soon)</div>} />
          <Route path="/about" element={<div>About Page (Coming Soon)</div>} />
        </Route>
        {/* Standalone pages without Layout */}
        <Route path="/novus-migration-status" element={<NovusMigrationStatus />} />
      </Routes>
      <Analytics />
    </BrowserRouter>
  </StrictMode>,
)
```

**Validation**:
```bash
npm run build
npm run lint
```
**Completion Criteria**:
- [ ] Routes defined for all planned pages
- [ ] Layout wraps homepage and service pages
- [ ] Novus page remains standalone
- [ ] Hash scroll works for cross-page navigation

---

## Phase 6: Refactor App.jsx to Use Shared Components

### Subtask 6.1: Update App.jsx Imports
**File**: `/home/pbrown/aireadypdx/src/App.jsx`
**Instructions**:
1. Remove inline Icons definition (lines 8-178)
2. Import Icons from shared component
3. Remove ChatWidget and NewsletterPopup imports (now in Layout)
4. Remove navigation JSX (now in Navigation component)
5. Remove footer JSX (now in Footer component)
6. Remove the outer `<div className="app">` wrapper (now in Layout)

**Key Changes**:
- Delete lines 8-178 (Icons object)
- Update import: `import { Icons } from './components/Icons/Icons'`
- Remove: `import ChatWidget from './components/ChatWidget/ChatWidget'`
- Remove: `import NewsletterPopup from './components/NewsletterPopup'`
- Remove navigation JSX (lines 278-305)
- Remove mobile sticky CTA (lines 307-312) - needs to move to Navigation or Layout
- Remove footer JSX (lines 886-915)
- Remove ChatWidget and NewsletterPopup at end (lines 917-921)
- Change outer wrapper from `<div className="app">` to a fragment or simple div

**Note**: The `scrollToSection` function can be removed from App.jsx since Navigation handles it internally now.

**Validation**:
```bash
npm run build
npm run lint
```
**Completion Criteria**:
- [ ] Icons imported from shared component
- [ ] Navigation removed from App.jsx
- [ ] Footer removed from App.jsx
- [ ] No duplicate components
- [ ] All Icons still work throughout App.jsx

### Subtask 6.2: Handle Mobile Sticky CTA
**File**: Determine location (Navigation or separate component)
**Instructions**:
1. The mobile sticky CTA (lines 307-312) needs to be handled
2. Option A: Move to Navigation component (shares scroll logic)
3. Option B: Move to Layout component
4. Option C: Create separate component

**Recommendation**: Move to Layout component since it appears on all pages and is part of the page shell.

**Code to add to Layout.jsx**:
```jsx
import { useState, useEffect } from 'react'
import { useLocation, useNavigate } from 'react-router-dom'

function Layout() {
  const [showMobileCTA, setShowMobileCTA] = useState(false)
  const location = useLocation()
  const navigate = useNavigate()

  useEffect(() => {
    const handleScroll = () => {
      const scrollY = window.scrollY
      const heroHeight = document.getElementById('home')?.offsetHeight || 500
      setShowMobileCTA(scrollY > heroHeight)
    }
    window.addEventListener('scroll', handleScroll, { passive: true })
    return () => window.removeEventListener('scroll', handleScroll)
  }, [])

  const handleCTAClick = (e) => {
    e.preventDefault()
    if (location.pathname === '/') {
      // Same-page scroll
      const element = document.getElementById('contact')
      if (element) {
        const offset = 80
        const elementPosition = element.getBoundingClientRect().top
        const offsetPosition = elementPosition + window.pageYOffset - offset
        window.scrollTo({ top: offsetPosition, behavior: 'smooth' })
      }
    } else {
      navigate('/#contact')
    }
  }

  return (
    <div className="app">
      <Navigation />
      <div className={`mobile-sticky-cta ${showMobileCTA ? 'visible' : ''}`}>
        <a href="#contact" onClick={handleCTAClick} className="btn btn-primary">
          Book a 15-Min Strategy Call
        </a>
      </div>
      <Outlet />
      <Footer />
      <ChatWidget />
      <NewsletterPopup />
    </div>
  )
}
```

**Validation**:
```bash
npm run build
npm run dev  # Test visually on mobile viewport
```
**Completion Criteria**:
- [ ] Mobile CTA appears after scrolling past hero
- [ ] CTA navigation works on homepage
- [ ] CTA navigation works from other pages

---

## Phase 7: Testing and Verification

### Subtask 7.1: Build and Lint Verification
**Instructions**:
```bash
cd /home/pbrown/aireadypdx
npm run build
npm run lint
```
**Completion Criteria**:
- [ ] Build passes without errors
- [ ] Lint passes without warnings

### Subtask 7.2: Visual Testing Checklist
**Instructions**:
1. Run `npm run dev`
2. Test the following scenarios:

**Homepage (`/`)**:
- [ ] Navigation renders correctly
- [ ] Mobile menu toggles on/off
- [ ] All nav links scroll to correct sections smoothly
- [ ] Footer renders correctly with all links
- [ ] ChatWidget appears and functions
- [ ] Newsletter popup works (via footer link)
- [ ] Mobile sticky CTA appears after scrolling
- [ ] All Icons display correctly throughout page

**Service Pages (`/services/*`)**:
- [ ] Navigation renders
- [ ] Nav links navigate to homepage with correct section scroll
- [ ] Footer renders
- [ ] Placeholder content displays

**Cross-Page Navigation**:
- [ ] Click "Services" on service page -> goes to homepage #services section
- [ ] Click "Contact" on service page -> goes to homepage #contact section
- [ ] Back button works correctly

**Standalone Pages**:
- [ ] `/novus-migration-status` still works independently

### Subtask 7.3: Responsive Testing
**Instructions**:
Test at these breakpoints:
- Desktop (1200px+)
- Tablet (992px)
- Mobile (768px)
- Small Mobile (480px)

**Completion Criteria**:
- [ ] Navigation collapses to hamburger on mobile
- [ ] Mobile menu opens/closes correctly
- [ ] Footer stacks correctly on mobile
- [ ] Mobile sticky CTA appears only on mobile

---

## Summary of Deliverables

**Files Created**:
- `/home/pbrown/aireadypdx/src/components/Icons/Icons.jsx`
- `/home/pbrown/aireadypdx/src/components/Navigation/Navigation.jsx`
- `/home/pbrown/aireadypdx/src/components/Navigation/Navigation.css`
- `/home/pbrown/aireadypdx/src/components/Footer/Footer.jsx`
- `/home/pbrown/aireadypdx/src/components/Footer/Footer.css`
- `/home/pbrown/aireadypdx/src/components/Layout/Layout.jsx`
- `/home/pbrown/aireadypdx/src/components/Layout/Layout.css`

**Files Modified**:
- `/home/pbrown/aireadypdx/src/main.jsx` - Updated routing structure
- `/home/pbrown/aireadypdx/src/App.jsx` - Removed extracted components, updated imports

**Files Unchanged** (keep for now, cleanup later):
- `/home/pbrown/aireadypdx/src/index.css` - Keep all styles, extract duplicates later
- `/home/pbrown/aireadypdx/src/App.css` - Keep existing styles

---

## Handoff to Build Agent

1. Execute subtasks in exact order (Phases 1-7)
2. Test completion criteria before moving to next subtask
3. Follow the component patterns exactly as shown
4. Run `npm run dev` for visual verification after each major phase
5. Pay special attention to:
   - Navigation scroll behavior on homepage vs other pages
   - Mobile menu state management
   - Hash-based navigation for cross-page scrolling
   - `__BUILD_TIME__` variable in Footer (Vite provides this)

**Critical Implementation Notes**:
- react-router-dom v7 is already installed - no npm install needed
- Use `useLocation()` and `useNavigate()` from react-router-dom for navigation logic
- The `Outlet` component from react-router-dom renders child routes
- Keep styles in both component CSS and index.css initially to avoid breaking anything

---

## Performance Metrics

| Phase | Duration |
|-------|----------|
| Issue Classification | 2m |
| Investigation (file reading) | 5m |
| Pattern Identification | 3m |
| Validation (build/lint) | 2m |
| Planning | 15m |
| **Total** | **27m** |

---

## Insights and Process Improvements (REQUIRED)

### Issues Encountered During Investigation
1. **Large monolithic component** - App.jsx at 927 lines made identification of extraction boundaries time-consuming. The issue description helped by providing line number references, but they were slightly off from actual file.
2. **State management complexity** - Multiple useState hooks in App.jsx required careful analysis to determine what stays vs what moves. The `mobileMenuOpen` state logically belongs with Navigation, but other states like `showMobileCTA` could go in multiple places.
3. **CSS organization** - Styles are split between index.css and App.css with some overlap. The extraction will temporarily create style duplication.

### Input Quality Assessment
**Clarity of Original Request**: 4/5
**Missing Information**:
- Specific line numbers for Navigation and Footer were not precise
- No mention of the Mobile Sticky CTA component and where it should live
- No guidance on whether to use index.js barrel exports or direct imports
**Suggested Input Improvements**:
- Include file line counts/sizes to help with scope estimation
- Specify component export pattern preference (barrel exports vs direct)
- Call out any tricky state management decisions explicitly

### Process Improvement Suggestions

**For Future Scout-and-Plan Runs**:
1. For large architectural changes, explicitly list all useState hooks and their logical homes
2. Include a "State Management Plan" section for complex component extractions
3. Add a "CSS Strategy" section when extracting styles to new component files

**For Build Agent**:
1. The ScrollToHash component in main.jsx is critical for cross-page navigation - test thoroughly
2. Test the mobile menu specifically - state now lives in Navigation instead of App
3. After implementing, consider a follow-up issue to deduplicate CSS between component files and index.css

**For Overall Workflow**:
1. This is a foundational change - subsequent service page issues (#17-22) depend on this working correctly
2. Consider adding a "dependency verification" step before closing this issue to ensure the foundation is solid
3. Future issues should reference specific component files created here rather than assuming everything is in App.jsx
